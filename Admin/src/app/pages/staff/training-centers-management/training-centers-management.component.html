<div class="container-fluid">
    <h2>Gestion des Centres de Formation et Campus (Staff)</h2>
    
    <!-- Onglets -->
    <mat-tab-group [(selectedIndex)]="selectedTabIndex" class="mb-4">
        <!-- Onglet Centres de Formation -->
        <mat-tab label="Centres de Formation">
            <div class="mt-3">
                <!-- Barre d'outils -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-primary" (click)="refreshTrainingCenters()" [disabled]="refreshing">
                                <i class="bx bx-refresh" [class.bx-spin]="refreshing"></i>
                                {{ refreshing ? 'Actualisation...' : 'Actualiser' }}
                            </button>
                            <button class="btn btn-outline-info" (click)="exportTrainingCentersToExcel()">
                                <i class="bx bx-export"></i>
                                Exporter
                            </button>
                        </div>
                    </div>
                    <div class="col-md-6 text-end">
                        <div class="d-flex gap-2 justify-content-end">
                            <button class="btn btn-outline-secondary" (click)="toggleAdvancedFilters()">
                                <i class="bx bx-filter-alt"></i>
                                {{ showAdvancedFilters ? 'Masquer' : 'Afficher' }} les filtres
                            </button>
                            <button class="btn btn-soft-primary waves-effect waves-light" 
                                    (click)="openCreateModal()">
                                <i class="bx bx-plus"></i> Créer un Centre
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Filtres avancés pour les centres de formation -->
                <div class="row mb-3" *ngIf="showAdvancedFilters">
                    <div class="col-12">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">
                                    <i class="bx bx-filter-alt me-2"></i>
                                    Filtres avancés - Centres de formation
                                </h6>
                            </div>
                            <div class="card-body">
                                <form [formGroup]="filterForm" class="row g-3">
                                    <div class="col-md-3">
                                        <label class="form-label">Division</label>
                                        <select class="form-select" formControlName="division">
                                            <option value="">Toutes</option>
                                            <option value="Adamaoua">Adamaoua</option>
                                            <option value="Centre">Centre</option>
                                            <option value="Est">Est</option>
                                            <option value="Extrême-Nord">Extrême-Nord</option>
                                            <option value="Littoral">Littoral</option>
                                            <option value="Nord">Nord</option>
                                            <option value="Nord-Ouest">Nord-Ouest</option>
                                            <option value="Ouest">Ouest</option>
                                            <option value="Sud">Sud</option>
                                            <option value="Sud-Ouest">Sud-Ouest</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label">Statut</label>
                                        <select class="form-select" formControlName="status">
                                            <option value="">Tous</option>
                                            <option value="ACTIVE">Actif</option>
                                            <option value="INACTIVE">Inactif</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label">Acronyme</label>
                                        <input type="text" class="form-control" formControlName="acronym" placeholder="Acronyme">
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label">Promoteur</label>
                                        <input type="text" class="form-control" formControlName="promoter" placeholder="Nom du promoteur">
                                    </div>
                                    <div class="col-12">
                                        <div class="d-flex gap-2">
                                            <button type="button" class="btn btn-primary" (click)="applyAdvancedFilters()">
                                                <i class="bx bx-search"></i>
                                                Appliquer les filtres
                                            </button>
                                            <button type="button" class="btn btn-outline-secondary" (click)="clearFilters()">
                                                <i class="bx bx-x"></i>
                                                Effacer
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Statistiques des centres de formation -->
                <div class="row">
                    <div *ngFor="let stat of followUpStat" class="col-md-4">
                        <app-stat [title]="stat.title" [value]="stat.value" [icon]="stat.icon"></app-stat>
                    </div>
                </div>
                
                <!-- Table des centres de formation -->
                <div class="row mt-3">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="row justify-content-between mb-3">
                                    <div class="col-md-4">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Filtrer les centres</mat-label>
                                            <input matInput (keyup)="applyFilter($event)" #input placeholder="Rechercher par nom ou acronyme">
                                            <mat-icon matSuffix>search</mat-icon>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-2 text-end">
                                        <button mat-icon-button matTooltip="Refresh list" (click)="loadTrainingCenters()">
                                            <mat-icon>refresh</mat-icon>
                                        </button>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table mat-table [dataSource]="dataSource" matSort class="w-100">
                                        <!-- Name Column -->
                                        <ng-container matColumnDef="fullName">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Nom </th>
                                            <td mat-cell *matCellDef="let center"> 
                                                <span class="fw-semibold">{{center.fullName || 'N/A'}}</span>
                                            </td>
                                        </ng-container>
                                        <!-- Acronym Column -->
                                        <ng-container matColumnDef="acronym">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Acronyme </th>
                                            <td mat-cell *matCellDef="let center"> 
                                                <span class="badge bg-primary">{{center.acronym || 'N/A'}}</span>
                                            </td>
                                        </ng-container>
                                        <!-- Agreement Number Column -->
                                        <ng-container matColumnDef="agreementNumber">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Numéro d'agrément </th>
                                            <td mat-cell *matCellDef="let center"> 
                                                <span class="badge bg-info">{{center.agreementNumber || 'N/A'}}</span>
                                            </td>
                                        </ng-container>
                                        <!-- Division Column -->
                                        <ng-container matColumnDef="division">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Division </th>
                                            <td mat-cell *matCellDef="let center"> 
                                                {{center.division || 'N/A'}}
                                            </td>
                                        </ng-container>
                                        <!-- Promoter Column -->
                                        <ng-container matColumnDef="promoter">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Promoteur </th>
                                            <td mat-cell *matCellDef="let center"> 
                                                {{center.promoter || 'N/A'}}
                                            </td>
                                        </ng-container>
                                        <!-- Status Column -->
                                        <ng-container matColumnDef="status">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Statut </th>
                                            <td mat-cell *matCellDef="let center"> 
                                                <span [ngClass]="{
                                                  'badge bg-success': (center.trainingCenterStatusHistory?.status || center.status) === 'VALIDATED',
                                                  'badge bg-warning': (center.trainingCenterStatusHistory?.status || center.status) === 'PENDING' || (center.trainingCenterStatusHistory?.status || center.status) === 'DRAFT',
                                                  'badge bg-danger': (center.trainingCenterStatusHistory?.status || center.status) === 'REJECTED',
                                                  'badge bg-info': (center.trainingCenterStatusHistory?.status || center.status) === 'INCOMPLETED',
                                                  'badge bg-primary': (center.trainingCenterStatusHistory?.status || center.status) === 'READYTOPAY',
                                                  'badge bg-secondary': (center.trainingCenterStatusHistory?.status || center.status) === 'PAID'
                                                }">
                                                  {{ center.trainingCenterStatusHistory?.status || center.status || 'N/A' }}
                                                </span>
                                            </td>
                                        </ng-container>
                                        <!-- Actions Column -->
                                        <ng-container matColumnDef="actions">
                                            <th mat-header-cell *matHeaderCellDef class="text-end"> Actions </th>
                                            <td mat-cell *matCellDef="let center" class="text-end">
                                                <div class="d-flex justify-content-end gap-1">
                                                    <button mat-icon-button color="primary" matTooltip="Voir détail" (click)="openDetailModal(center)">
                                                        <mat-icon>visibility</mat-icon>
                                                    </button>
                                                    <button mat-icon-button color="accent" matTooltip="Modifier" (click)="edit(center)">
                                                        <mat-icon>edit</mat-icon>
                                                    </button>
                                                    <button mat-icon-button color="warn" matTooltip="Supprimer" (click)="delete(center)" [disabled]="processing">
                                                        <mat-icon>delete</mat-icon>
                                                    </button>
                                                    <button mat-icon-button color="warning" matTooltip="Changer le statut" (click)="onChangeStatus(center)">
                                                        <mat-icon>autorenew</mat-icon>
                                                    </button>
                                                </div>
                                            </td>
                                        </ng-container>
                                        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                                        <tr class="mat-row" *matNoDataRow>
                                            <td class="mat-cell text-center py-4" colspan="7">
                                                <div class="d-flex flex-column align-items-center">
                                                    <mat-icon class="mb-2" style="font-size: 48px; height: 48px; width: 48px;">search_off</mat-icon>
                                                    <h4 class="text-muted">Aucun centre de formation trouvé</h4>
                                                    <p *ngIf="input.value" class="text-muted">
                                                        Aucun résultat pour "{{input.value}}"
                                                    </p>
                                                    <button mat-raised-button color="primary" class="mt-2" (click)="openCreateModal()" *ngIf="!input.value">
                                                        Créer votre premier centre de formation
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" showFirstLastButtons aria-label="Select page of training centers" class="mt-3"></mat-paginator>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </mat-tab>
        
        <!-- Onglet Campus -->
        <mat-tab label="Campus">
            <div class="mt-3">
                <!-- Barre d'outils -->
                <div class="row mb-3">
                    <div class="col-md-6">
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-primary" (click)="refreshCampuses()" [disabled]="campusRefreshing">
                                <i class="bx bx-refresh" [class.bx-spin]="campusRefreshing"></i>
                                {{ campusRefreshing ? 'Actualisation...' : 'Actualiser' }}
                            </button>
                            <button class="btn btn-outline-info" (click)="exportCampusesToExcel()">
                                <i class="bx bx-export"></i>
                                Exporter
                            </button>
                            <button class="btn btn-outline-secondary" (click)="loadCampuses()">
                                <i class="bx bx-list-ul"></i>
                                Afficher tous les campus
                            </button>
                        </div>
                    </div>
                    <div class="col-md-6 text-end">
                        <div class="d-flex gap-2 justify-content-end">
                            <button class="btn btn-outline-secondary" (click)="toggleCampusAdvancedFilters()">
                                <i class="bx bx-filter-alt"></i>
                                {{ campusShowAdvancedFilters ? 'Masquer' : 'Afficher' }} les filtres
                            </button>
                            <button class="btn btn-soft-primary waves-effect waves-light" 
                                    (click)="openCreateCampusModal()">
                                <i class="bx bx-plus"></i> Créer un Campus
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Filtres avancés pour les campus -->
                <div class="row mb-3" *ngIf="campusShowAdvancedFilters">
                    <div class="col-12">
                        <div class="card border-0 shadow-sm">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">
                                    <i class="bx bx-filter-alt me-2"></i>
                                    Filtres avancés - Campus
                                </h6>
                            </div>
                            <div class="card-body">
                                <form [formGroup]="campusFilterForm" class="row g-3">
                                    <div class="col-md-3">
                                        <label class="form-label">Ville</label>
                                        <input type="text" class="form-control" formControlName="town" placeholder="Filtrer par ville">
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label">Quartier</label>
                                        <input type="text" class="form-control" formControlName="quarter" placeholder="Filtrer par quartier">
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label">Centre de formation</label>
                                        <select class="form-select" formControlName="trainingCenter">
                                            <option value="">Tous les centres</option>
                                            <option *ngFor="let center of dataSource.data" [value]="center.agreementNumber">
                                                {{ center.fullName }}
                                            </option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label class="form-label">Capacité minimum</label>
                                        <input type="number" class="form-control" formControlName="minCapacity" placeholder="0">
                                    </div>
                                    <div class="col-12">
                                        <div class="d-flex gap-2">
                                            <button type="button" class="btn btn-primary" (click)="applyCampusAdvancedFilters()">
                                                <i class="bx bx-search"></i>
                                                Appliquer les filtres
                                            </button>
                                            <button type="button" class="btn btn-outline-secondary" (click)="clearCampusFilters()">
                                                <i class="bx bx-x"></i>
                                                Effacer
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Statistiques des campus -->
                <div class="row">
                    <div *ngFor="let stat of campusStats" class="col-md-4">
                        <app-stat [title]="stat.title" [value]="stat.value" [icon]="stat.icon"></app-stat>
                    </div>
                </div>
                
                <!-- Table des campus -->
                <div class="row mt-3">
                    <div class="col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="row justify-content-between mb-3">
                                    <div class="col-md-4">
                                        <mat-form-field appearance="outline" class="w-100">
                                            <mat-label>Filtrer les campus</mat-label>
                                            <input matInput (keyup)="applyCampusFilter($event)" #campusInput placeholder="Rechercher par nom ou ville">
                                            <mat-icon matSuffix>search</mat-icon>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-2 text-end">
                                        <button mat-icon-button matTooltip="Refresh list" (click)="loadCampuses()">
                                            <mat-icon>refresh</mat-icon>
                                        </button>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <table mat-table [dataSource]="campusDataSource" matSort class="w-100">
                                        <!-- Name Column -->
                                        <ng-container matColumnDef="name">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Nom </th>
                                            <td mat-cell *matCellDef="let campus"> 
                                                <span class="fw-semibold">{{campus.name || 'N/A'}}</span>
                                            </td>
                                        </ng-container>
                                        <!-- Town Column -->
                                        <ng-container matColumnDef="town">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Ville </th>
                                            <td mat-cell *matCellDef="let campus"> 
                                                {{campus.town || 'N/A'}}
                                            </td>
                                        </ng-container>
                                        <!-- Quarter Column -->
                                        <ng-container matColumnDef="quarter">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Quartier </th>
                                            <td mat-cell *matCellDef="let campus"> 
                                                {{campus.quarter || 'N/A'}}
                                            </td>
                                        </ng-container>
                                        <!-- Capacity Column -->
                                        <ng-container matColumnDef="capacity">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Capacité </th>
                                            <td mat-cell *matCellDef="let campus"> 
                                                <span class="badge bg-info">{{campus.capacity || 0}} étudiants</span>
                                            </td>
                                        </ng-container>
                                        <!-- Training Center Column -->
                                        <ng-container matColumnDef="trainingCenter">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Centre de formation </th>
                                            <td mat-cell *matCellDef="let campus"> 
                                                <small>{{campus.trainingCenterCampus?.fullName || 'N/A'}}</small>
                                                <br>
                                                <small class="text-muted">{{campus.trainingCenterCampus?.agreementNumber || ''}}</small>
                                            </td>
                                        </ng-container>
                                        <!-- Coordinates Column -->
                                        <ng-container matColumnDef="coordinates">
                                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Coordonnées </th>
                                            <td mat-cell *matCellDef="let campus"> 
                                                <small>({{campus.xcoor || 0}}, {{campus.ycoor || 0}})</small>
                                            </td>
                                        </ng-container>
                                        <!-- Actions Column -->
                                        <ng-container matColumnDef="actions">
                                            <th mat-header-cell *matHeaderCellDef class="text-end"> Actions </th>
                                            <td mat-cell *matCellDef="let campus" class="text-end">
                                                <div class="d-flex justify-content-end gap-1">
                                                    <button mat-icon-button color="primary" matTooltip="Voir détail" (click)="openCampusDetailModal(campus)">
                                                        <mat-icon>visibility</mat-icon>
                                                    </button>
                                                    <button mat-icon-button color="accent" matTooltip="Modifier" (click)="editCampus(campus)">
                                                        <mat-icon>edit</mat-icon>
                                                    </button>
                                                    <button mat-icon-button color="warn" matTooltip="Supprimer" (click)="deleteCampus(campus)" [disabled]="campusProcessing">
                                                        <mat-icon>delete</mat-icon>
                                                    </button>
                                                </div>
                                            </td>
                                        </ng-container>
                                        <tr mat-header-row *matHeaderRowDef="campusDisplayedColumns"></tr>
                                        <tr mat-row *matRowDef="let row; columns: campusDisplayedColumns;"></tr>
                                        <tr class="mat-row" *matNoDataRow>
                                            <td class="mat-cell text-center py-4" colspan="7">
                                                <div class="d-flex flex-column align-items-center">
                                                    <mat-icon class="mb-2" style="font-size: 48px; height: 48px; width: 48px;">location_off</mat-icon>
                                                    <h4 class="text-muted">Aucun campus trouvé</h4>
                                                    <p *ngIf="campusInput.value" class="text-muted">
                                                        Aucun résultat pour "{{campusInput.value}}"
                                                    </p>
                                                    <button mat-raised-button color="primary" class="mt-2" (click)="openCreateCampusModal()" *ngIf="!campusInput.value">
                                                        Créer votre premier campus
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]" showFirstLastButtons aria-label="Select page of campuses" class="mt-3"></mat-paginator>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </mat-tab>
    </mat-tab-group>

    <!-- Modal pour les centres de formation -->
    <div class="modal fade show" [ngClass]="{'d-block': showModal}" tabindex="-1" role="dialog" *ngIf="showModal">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">{{isEditMode ? 'Modifier' : 'Créer'}} un Centre de Formation</h5>
                    <button type="button" class="btn-close" (click)="showModal = false" aria-label="Close"></button>
                </div>
                <form [formGroup]="trainingCenterForm" (ngSubmit)="onSubmit()">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Nom complet *</label>
                                    <input type="text" class="form-control" formControlName="fullName" placeholder="Nom du centre">
                                    <div *ngIf="f['fullName'].touched && f['fullName'].invalid" class="text-danger">
                                        <small *ngIf="f['fullName'].errors?.['required']">Le nom est requis</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Acronyme *</label>
                                    <input type="text" class="form-control" formControlName="acronym" placeholder="Acronyme">
                                    <div *ngIf="f['acronym'].touched && f['acronym'].invalid" class="text-danger">
                                        <small *ngIf="f['acronym'].errors?.['required']">L'acronyme est requis</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Numéro d'agrément *</label>
                                    <input type="text" class="form-control" formControlName="agreementNumber" placeholder="Numéro d'agrément">
                                    <div *ngIf="f['agreementNumber'].touched && f['agreementNumber'].invalid" class="text-danger">
                                        <small *ngIf="f['agreementNumber'].errors?.['required']">Le numéro d'agrément est requis</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Division *</label>
                                    <select class="form-select" formControlName="division">
                                        <option value="">Sélectionner une division</option>
                                        <option value="Adamaoua">Adamaoua</option>
                                        <option value="Centre">Centre</option>
                                        <option value="Est">Est</option>
                                        <option value="Extrême-Nord">Extrême-Nord</option>
                                        <option value="Littoral">Littoral</option>
                                        <option value="Nord">Nord</option>
                                        <option value="Nord-Ouest">Nord-Ouest</option>
                                        <option value="Ouest">Ouest</option>
                                        <option value="Sud">Sud</option>
                                        <option value="Sud-Ouest">Sud-Ouest</option>
                                    </select>
                                    <div *ngIf="f['division'].touched && f['division'].invalid" class="text-danger">
                                        <small *ngIf="f['division'].errors?.['required']">La division est requise</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Date début agrément</label>
                                    <input type="date" class="form-control" formControlName="startDateOfAgreement">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Date fin agrément</label>
                                    <input type="date" class="form-control" formControlName="endDateOfAgreement">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Type d'examen</label><br>
                                    <mat-checkbox formControlName="centerPresentCandidateForCqp">CQP</mat-checkbox>
                                    <mat-checkbox formControlName="centerPresentCandidateForDqp">DQP</mat-checkbox>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" (click)="showModal = false">Annuler</button>
                        <button type="submit" class="btn btn-primary" [disabled]="processing || trainingCenterForm.invalid">
                            {{isEditMode ? 'Mettre à jour' : 'Créer'}}
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal pour les campus -->
    <div class="modal fade show" [ngClass]="{'d-block': campusShowModal}" tabindex="-1" role="dialog" *ngIf="campusShowModal">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">{{campusIsEditMode ? 'Modifier' : 'Créer'}} un Campus</h5>
                    <button type="button" class="btn-close" (click)="campusShowModal = false" aria-label="Close"></button>
                </div>
                <form [formGroup]="campusForm" (ngSubmit)="campusShowModal = false">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Nom du campus *</label>
                                    <input type="text" class="form-control" formControlName="name" placeholder="Nom du campus">
                                    <div *ngIf="campusForm.get('name')?.touched && campusForm.get('name')?.invalid" class="text-danger">
                                        <small *ngIf="campusForm.get('name')?.errors?.['required']">Le nom est requis</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Ville *</label>
                                    <input type="text" class="form-control" formControlName="town" placeholder="Ville">
                                    <div *ngIf="campusForm.get('town')?.touched && campusForm.get('town')?.invalid" class="text-danger">
                                        <small *ngIf="campusForm.get('town')?.errors?.['required']">La ville est requise</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Quartier *</label>
                                    <input type="text" class="form-control" formControlName="quarter" placeholder="Quartier">
                                    <div *ngIf="campusForm.get('quarter')?.touched && campusForm.get('quarter')?.invalid" class="text-danger">
                                        <small *ngIf="campusForm.get('quarter')?.errors?.['required']">Le quartier est requis</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Capacité *</label>
                                    <input type="number" class="form-control" formControlName="capacity" placeholder="Nombre d'étudiants" min="1">
                                    <div *ngIf="campusForm.get('capacity')?.touched && campusForm.get('capacity')?.invalid" class="text-danger">
                                        <small *ngIf="campusForm.get('capacity')?.errors?.['required']">La capacité est requise</small>
                                        <small *ngIf="campusForm.get('capacity')?.errors?.['min']">La capacité doit être positive</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Centre de formation *</label>
                                    <select class="form-select" formControlName="trainingCenterAgr">
                                        <option value="">Sélectionner un centre</option>
                                        <option *ngFor="let center of dataSource.data" [value]="center.agreementNumber">
                                            {{ center.fullName }} ({{ center.agreementNumber }})
                                        </option>
                                    </select>
                                    <div *ngIf="campusForm.get('trainingCenterAgr')?.touched && campusForm.get('trainingCenterAgr')?.invalid" class="text-danger">
                                        <small *ngIf="campusForm.get('trainingCenterAgr')?.errors?.['required']">Le centre de formation est requis</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label class="form-label">Coordonnée X</label>
                                    <input type="number" step="0.000001" class="form-control" formControlName="xCoor" placeholder="0">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3">
                                    <label class="form-label">Coordonnée Y</label>
                                    <input type="number" step="0.000001" class="form-control" formControlName="yCoor" placeholder="0">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" (click)="campusShowModal = false">Annuler</button>
                        <button type="submit" class="btn btn-primary" [disabled]="campusProcessing || campusForm.invalid">
                            {{campusIsEditMode ? 'Mettre à jour' : 'Créer'}}
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>